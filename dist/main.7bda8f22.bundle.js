(()=>{var e={id:179,ids:[179]};e.modules={3858:(e,s,t)=>{const a=t(9192),i=t(4870),{validationResult:r}=t(7756);t(334).config(),e.exports=new class{getAll=async(e,s,t)=>{const r=await a.find({type:{$ne:"release"}});if(!r)throw new i(404,"Abouts not found");s.send(r)};getById=async(e,s,t)=>{const r=await a.findOne({_id:e.params.id});if(!r)throw new i(404,"About not found");s.send(r)};getReleases=async(e,s,t)=>{const r=await a.find({type:"release"}).sort({create_date:-1});if(!r)throw new i(404,"Releases not found");s.send(r)};getReleaseById=async(e,s,t)=>{const r=await a.findOne({_id:e.params.id});if(!r)throw new i(404,"Release not found");s.send(r)};getByType=async(e,s,t)=>{const r=await a.findOne({type:e.params.type});if(!r)throw new i(404,"About not found");s.send(r)};create=async(e,s,t)=>{this.checkValidation(e);var r={...e.body,create_date:new Date};const n=await a.create(r);if(!n)throw new i(500,"Something went wrong");s.status(201).send(n)};update=async(e,s,t)=>{this.checkValidation(e);const r=await a.updateOne({_id:e.params.id},e.body);if(!r)throw new i(404,"Something went wrong");const{affectedRows:n,changedRows:o,info:d}=r,l=n?n&&o?"About updated successfully":"Updated faild":"About not found";s.send({message:l,info:d})};delete=async(e,s,t)=>{if(!await a.delete(e.params.id))throw new i(404,"About not found");s.send("About has been deleted")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},1970:(e,s,t)=>{const a=t(6056),i=(t(7693),t(4870)),{validationResult:r}=t(7756),n=t(2773),o=(t(9722),t(334)),{authLogger:d}=(t(5068),t(615)),l=t(9974);o.config(),e.exports=new class{verify=async(e,s,t)=>{const{password:a,...i}=e.currentUser._doc;s.send({...i})};verifySso=async(e,s,t)=>{const{ssoToken:a}=e.query;s.status(200).json(!0)};register=async(e,s,t)=>{if(this.checkValidation(e),await a.findOne({$or:[{email:e.body.email},{username:e.body.username}]}))throw new i(401,"User already exists!");await this.hashPassword(e);var r={...e.body,create_date:new Date,update_date:null};await a.create(r).then((t=>{e.session.isAuth=!0,e.session.user_id=t._id,s.status(201).send(!0)}))};googleRegister=async(e,s,t)=>{var a=l.getUrl(e.body);s.send(a)};login=(e,s,t)=>(e.session.user_id&&s.redirect(e.headers["x-forwarded-proto"]+"://"+e.headers["x-forwarded-host"]),s.render("login",{title:"SSO-Server | Login"}));doLogin=async(e,s,t)=>{console.log(e.headers.origin.split(":")[1]);const{email:r,password:o}=e.body;var l;if(!(l=await a.findOne({email:r})))throw d.error(`401 : Unable to login! Email: ${r}`),new i(401,"Unable to login!");if(!await n.compare(o,l.password))throw d.error(`401 : Incorrect password! User: ${l.first_name} ${l.last_name} (${r})`),new i(401,"Incorrect password!");e.session.isAuth=!0,e.session.user_id=l._id,s.header("Access-Control-Allow-Credentials",!0),s.send(!0)};googleLogin=async(e,s,t)=>{};resetPassword=async(e,s,t)=>{this.checkValidation(e),await this.hashPassword(e),a.findOne({_id:e.params.id},(function(s,t){t.password=e.body.password,a.updateOne({_id:t._id},t)})),s.send("Updated!")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)};hashPassword=async e=>{e.body.password&&(e.body.password=await n.hash(e.body.password,8))}}},7395:(e,s,t)=>{const a=t(3310),i=t(4870),{validationResult:r}=t(7756);t(334).config(),e.exports=new class{getAll=async(e,s,t)=>{a.find((function(e,t){e&&console.log(e),s.send(t)}))};getByType=async(e,s,t)=>{const r=await a.findOne({type:e.params.type});if(!r)throw new i(404,"Category not found");s.send(r)};getById=async(e,s,t)=>{const r=await a.findOne({id:e.params.id});if(!r)throw new i(404,"Category not found");s.send(r)};create=async(e,s,t)=>{if(this.checkValidation(e),!await a.create(e.body))throw new i(500,"Something went wrong");s.status(201).send("Category was created!")};update=async(e,s,t)=>{this.checkValidation(e);const r=await a.updateOne({_id:e.params.id},e.body);if(!r)throw new i(404,"Something went wrong");const{affectedRows:n,changedRows:o,info:d}=r,l=n?n&&o?"Category updated successfully":"Updated faild":"Category not found";s.send({message:l,info:d})};delete=async(e,s,t)=>{if(!await a.delete(e.params.id))throw new i(404,"Category not found");s.send("Category has been deleted")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},9828:(e,s,t)=>{var a=t(1529);const i=t(4870),{validationResult:r}=t(7756),n=t(5068),o=t(6873);var d=t(4402);const l=t(334);var u=t(5619);l.config(),e.exports=new class{getAll=async(e,s,t)=>{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))};getPublishedAll=async(e,s,t)=>{await a.aggregate([{$match:{status:"Published"}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$project:{name:1,description:1,image_path:1,short_description:1,create_date:1,showcases:1,categories:1,tags:1,descriptions:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":1,"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}}}}],(function(e,t){e&&console.log(e),s.send(t)}))};getByUserPublishedAll=async(e,s,t)=>{const i=u.Types.ObjectId;var r=await a.aggregate([{$match:{user_id:i(e.params.user_id),status:"Published"}}]);s.send(r)};getFindAll=async(e,s,t)=>{a.find({name:{$regex:e.params.text,$options:"i"}},(function(e,t){e&&console.log(e),s.send(t)}))};getAllTop=async(e,s,t)=>{a.aggregate([{$sort:{finalTotal:-1}},{$limit:Number(e.params.count)}]).exec((function(e,t){s.send(t)}))};getById=async(e,s,t)=>{var a=(await this.byId(e.currentUser?e.currentUser.role:n.Client,e.params.id))[0];s.send(a)};getByUserId=async(e,s,t)=>{const i=u.Types.ObjectId;a.aggregate([{$match:{user_id:i(e.params.user_id)}}],(function(e,t){s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e);var i={...e.body,create_date:new Date},r=await a.create(i);e.currentUser.role==n.Client&&s.status(201).send(r);var o=(await this.byId(e.currentUser.role,r._id))[0];s.status(201).send(o)};update=async(e,s,t)=>{this.checkValidation(e),e.currentUser._id==e.body.user_id||e.currentUser.role!=n.Client?a.updateOne({_id:e.params.id},e.body).then((t=>{t.ok>0?s.status(200).send(e.body):s.status(500).send("GÃ¼ncellenmedi")})):s.status(403).send("Forbidden!")};updateImpression=async(e,s,t)=>{var r=await a.findOne({_id:e.body.id});r&&(0==r.impressions.filter((s=>s.ip==e.body.ip_address)).length?(r.impressions.push({ip:e.body.ip_address,count:1}),a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw new i(e);s.send("Updated!")}))):(r.impressions.find((s=>s.ip==e.body.ip_address)).count+=1,a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw new i(e);s.send("Updated!")}))))};delete=async(e,s,t)=>{var i=(await this.byId(e.currentUser.role,e.params.id))[0];if((await a.deleteOne({_id:e.params.id})).deletedCount>0){if(i.image_path){var r=new d(i.image_path,!0);await o.deleteFile(r.query.id)}i.descriptions.forEach((async e=>{if("image"==e.type){var s=new d(e.val,!0);await o.deleteFile(s.query.id)}})),s.status(200).send(e.params.id)}else s.status(500).send("Can't delete!")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)};async byId(e=n.Client,s){const t=u.Types.ObjectId;return e==n.Client?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$project:{name:1,description:1,image_path:1,short_description:1,create_date:1,showcases:1,categories:1,tags:1,descriptions:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":1,"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}}}},{$limit:1}]):e==n.Admin||e==n.SuperUser?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{user_id:0,"user_data.password":0}},{$limit:1}]):null}}},9371:(e,s,t)=>{const a=t(556);var i=t(5619);e.exports=new class{getAll=async(e,s,t)=>{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const r=i.Types.ObjectId;a.aggregate([{$match:{_id:r(e.params.id)}}],(function(e,t){s.send(t[0])}))};getByUserId=async(e,s,t)=>{const r=i.Types.ObjectId;a.aggregate([{$match:{user_id:r(e.params.user_id)}}],(function(e,t){s.send(t)}))};create=async(e,s,t)=>{var i={...e.body,create_date:new Date},r=await a.create(i);s.status(201).send(r)};update=async(e,s,t)=>{e.currentUser._id==e.body.user_id||"Client"!=e.currentUser.role?a.updateOne({_id:e.params.id},e.body).then((t=>{1==t.ok?s.status(200).send(e.body):s.status(500).send({status:500})})):s.status(403).send({status:403})};delete=async(e,s,t)=>{(await a.deleteOne({_id:e.params.id})).deletedCount>0?s.status(200).send(e.params.id):s.status(500).send("Can't delete!")}}},2387:(e,s,t)=>{var a=t(7233),i=t(8386);const r=t(4870),{validationResult:n}=t(7756),o=t(5068),d=t(334);var l=t(5619);d.config(),e.exports=new class{getAll=async(e,s,t)=>{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_id",foreignField:"user_id",as:"user_option"}},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))};getPublishedAll=async(e,s,t)=>{await a.aggregate([{$match:{status:"Published"}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_data._id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$lookup:{from:"users",localField:"comments.user_id",foreignField:"_id",as:"comments_user_data"}},{$lookup:{from:"useroptions",localField:"comments_user_data._id",foreignField:"user_id",as:"comments_user_option"}},{$project:{name:1,short_description:1,categories:1,connects:1,comments:1,description:1,create_date:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":1,"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}},"comments_user_data._id":1,"comments_user_data.image_path":{$cond:[{$eq:["$comments_user_option.isViewImagePath",!0]},"$comments_user_data.image_path","$$REMOVE"]},"comments_user_data.first_name":{$cond:[{$eq:["$comments_user_option.isViewFirstName",!0]},"$comments_user_data.first_name","$$REMOVE"]},"comments_user_data.last_name":{$cond:[{$eq:["$comments_user_option.isViewLastName",!0]},"$comments_user_data.last_name","$$REMOVE"]},"comments_user_data.email":{$cond:[{$eq:["$comments_user_option.isViewEmail",!0]},"$comments_user_data.email","$$REMOVE"]},"comments_user_data.username":1,"comments_user_data.title":{$cond:[{$eq:["$comments_user_option.isViewTitle",!0]},"$comments_user_data.title","$$REMOVE"]}}}],(function(e,t){e&&console.log(e),s.send(t)}))};getByUserPublishedAll=async(e,s,t)=>{const i=l.Types.ObjectId;var r=await a.aggregate([{$match:{user_id:i(e.params.user_id),status:"Published"}}]);s.send(r)};getFindAll=async(e,s,t)=>{a.find({name:{$regex:e.params.text,$options:"i"}},(function(e,t){e&&console.log(e),s.send(t)}))};getAllTop=async(e,s,t)=>{a.aggregate([{$sort:{finalTotal:-1}},{$limit:Number(e.params.count)}]).exec((function(e,t){s.send(t)}))};getById=async(e,s,t)=>{var a=(await this.byId(e.currentUser?e.currentUser.role:o.Client,e.params.id))[0];if(null==e.currentUser||e.currentUser.role==o.Client){var r=a.comments_user_data;for(let e=0;e<r.length;e++){var n=await i.findOne({user_id:r[e]._id}),d=[{opt:"isViewFirstName",key:"first_name"},{opt:"isViewLastName",key:"last_name"},{opt:"isViewEmail",key:"email"},{opt:"isViewImagePath",key:"image_path"},{opt:"isViewTitle",key:"title"}];let s={_id:r[e]._id,username:r[e].username};for(let t=0;t<d.length;t++)n[d[t].opt]&&(s={...s,[d[t].key]:r[e][d[t].key]});r[e]=s}}s.send(a)};getByUserId=async(e,s,t)=>{const i=l.Types.ObjectId;await a.aggregate([{$match:{user_id:i(e.params.user_id)}}],(function(e,t){e&&console.log(e),s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e);var i={...e.body,create_date:new Date},r=await a.create(i);e.currentUser.role==o.Client?s.status(201).send(r):s.status(201).send((await this.byId(e.currentUser.role,r._id))[0])};createComment=async(e,s,t)=>{var i=await a.findOne({_id:e.params.id}),r={id:i.comments.length>0?i.comments[i.comments.length-1].id+1:1,...e.body,create_date:new Date};i.comments.push({...r}),await a.updateOne({_id:i._id},i),s.status(201).send(r)};update=async(e,s,t)=>{var i={...e.body,update_date:new Date};e.currentUser._id==e.body.user_id||e.currentUser.role!=o.Client?a.updateOne({_id:e.params.id},i).then((e=>{e.ok>0?s.status(200).send(i):s.status(500).send("GÃ¼ncellenmedi")})):s.status(403).send("Forbidden!")};updateImpression=async(e,s,t)=>{var i=await a.findOne({_id:e.body.id});i&&(0==i.impressions.filter((s=>s.ip==e.body.ip_address)).length?(i.impressions.push({ip:e.body.ip_address,count:1}),a.updateOne({_id:i._id},i).then((e=>{if(!(e.ok>0))throw new r(e);s.send("Updated!")}))):(i.impressions.find((s=>s.ip==e.body.ip_address)).count+=1,a.updateOne({_id:i._id},i).then((e=>{if(!(e.ok>0))throw new r(e);s.send("Updated!")}))))};delete=async(e,s,t)=>{(await a.deleteOne({_id:e.params.id})).deletedCount>0?s.status(200).send(e.params.id):s.status(500).send("Can't delete!")};checkValidation=e=>{const s=n(e);if(!s.isEmpty())throw new r(400,"Validation faild",s)};byId=async(e,s)=>{const t=l.Types.ObjectId;return e==o.Client?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_data._id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$lookup:{from:"users",localField:"comments.user_id",foreignField:"_id",as:"comments_user_data"}},{$lookup:{from:"useroptions",localField:"comments_user_data._id",foreignField:"user_id",as:"comments_user_option"}},{$project:{name:1,short_description:1,categories:1,connects:1,comments:1,description:1,create_date:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":1,"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}},comments_user_data:1}},{$limit:1}]):e==o.Admin||e==o.SuperUser?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"users",localField:"comments.user_id",foreignField:"_id",as:"comments_user_data"}},{$project:{user_id:0,"user_data.password":0}},{$limit:1}]):null}}},914:(e,s,t)=>{var a=t(6699);const i=t(4870),{validationResult:r}=t(7756),n=t(5068),o=t(334);var d=t(5619);o.config(),e.exports=new class{getAll=async(e,s,t)=>{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"chapters",localField:"contents",foreignField:"_id",as:"chapters"}},{$lookup:{from:"news",localField:"contents",foreignField:"_id",as:"news"}},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const i=d.Types.ObjectId;a.aggregate([{$match:{_id:i(e.params.id)}},{$lookup:{from:"chapters",localField:"contents",foreignField:"_id",as:"chapters"}},{$lookup:{from:"news",localField:"contents",foreignField:"_id",as:"news"}}],(function(e,t){s.send(t[0])}))};getByUserId=async(e,s,t)=>{const i=d.Types.ObjectId;a.aggregate([{$match:{user_id:i(e.params.user_id)}},{$lookup:{from:"chapters",localField:"contents",foreignField:"_id",as:"chapters"}},{$lookup:{from:"news",localField:"contents",foreignField:"_id",as:"news"}}],(function(e,t){s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e);var i={...e.body,create_date:new Date},r=await a.create(i),n=await a.aggregate([{$match:{_id:r._id}},{$lookup:{from:"chapters",localField:"contents",foreignField:"_id",as:"chapters"}},{$lookup:{from:"news",localField:"contents",foreignField:"_id",as:"news"}},{$limit:1}]);n.length>0?s.status(201).send(n[0]):s.status(204).send("Ä°Ã§erik Yok")};uploadImage=async(e,s,t)=>{const a=e.files.photo;a.mv("./src/controllers/uploads/"+a.name,(function(e,t){if(e)throw e;s.send({success:!0,message:"File uploaded!",result:t})}))};update=async(e,s,t)=>{e.currentUser._id==e.body.user_id||e.currentUser.role!=n.Client?a.updateOne({_id:e.params.id},e.body).then((t=>{t.ok>0?s.status(200).send(e.body):s.status(304).send("GÃ¼ncellenmedi!")})):s.status(403).send("YasaklandÄ±!")};updateImpression=async(e,s,t)=>{a.findOne({_id:e.body.blog_id},(function(t,r){0==r.impressions.filter((s=>s.ip==e.body.ip_address)).length?(r.impressions.push({ip:e.body.ip_address,count:1}),a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw i(e);s.send("Updated!")}))):(r.impressions.find((s=>s.ip==e.body.ip_address)).count+=1,a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw i(e);s.send("Updated!")})))}))};delete=async(e,s,t)=>{a.deleteOne({_id:e.params.id},(e=>console.log(e)))?s.status(200).send(e.params.id):s.status(500).send("Can't delete!")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},6604:(e,s,t)=>{var a=t(7686);const i=t(4870),{validationResult:r}=t(7756),n=t(334);var o=t(5619);n.config(),e.exports=new class{getAll=async(e,s,t)=>{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const i=o.Types.ObjectId;a.aggregate([{$match:{_id:i(e.params.id)}},{$lookup:{from:"chapters",localField:"type.id",foreignField:"_id",as:"chapter"}},{$lookup:{from:"news",localField:"type.id",foreignField:"_id",as:"news"}},{$lookup:{from:"forums",localField:"type.id",foreignField:"_id",as:"forum"}}],(function(e,t){s.send(t[0])}))};getByUserId=async(e,s,t)=>{const i=o.Types.ObjectId;a.aggregate([{$match:{user_id:i(e.params.user_id)}},{$lookup:{from:"chapters",localField:"type.id",foreignField:"_id",as:"chapter"}},{$lookup:{from:"news",localField:"type.id",foreignField:"_id",as:"news"}},{$lookup:{from:"forums",localField:"type.id",foreignField:"_id",as:"forum"}}],(function(e,t){s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e);var i={...e.body,create_date:new Date};a.create(i),s.status(201).send("Log was created!")};update=async(e,s,t)=>{e.currentUser._id==e.body.user_data._id||"Client"!=e.currentUser.role?a.updateOne({_id:e.params.id},e.body).then((e=>{1==e.ok?s.send({status:200}):s.send({status:500})})):s.send({status:403})};delete=async(e,s,t)=>{a.deleteOne({_id:e.params.id},(e=>console.log(e))),s.send("Log has been deleted")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},6015:(e,s,t)=>{t(4870);const{validationResult:a}=t(7756);t(334).config(),e.exports=new class{sendMail=async(e,s,a)=>{let i=t(8123).createTransport({host:"mail.softelon.com",port:465,secure:!0,auth:{user:"software@softelon.com",pass:"Mhl597dR"}});i.verify((function(e,s){if(e)throw e}));let r={from:"YazÄ±lÄ±m <software@softelon.com>",to:"info@softelon.com",subject:"Sihirbaz Blog BaÅvuru",html:`<b>${e.body.email}</b><br/><b>${e.body.phone}</b><p>${e.body.text}</p>`};i.sendMail(r,(function(e,t){if(e)throw e;s.send("Eposta gÃ¶nderildi "+t.response)}))};mailCheck=async(e,s,t)=>{}}},8170:(e,s,t)=>{const a=t(5960),i=t(4870),{validationResult:r}=t(7756);t(334).config(),e.exports=new class{getAll=async(e,s,t)=>{a.find((function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const a=await MenuModel.findOne({id:e.params.id});if(!a)throw new i(404,"Menu not found");s.send(a)};create=async(e,s,t)=>{if(this.checkValidation(e),!await MenuModel.create(e.body))throw new i(500,"Something went wrong");s.status(201).send("Menu was created!")};update=async(e,s,t)=>{this.checkValidation(e);const a=await MenuModel.update(e.body,e.params.id);if(!a)throw new i(404,"Something went wrong");const{affectedRows:r,changedRows:n,info:o}=a,d=r?r&&n?"Menu updated successfully":"Updated faild":"Menu not found";s.send({message:d,info:o})};delete=async(e,s,t)=>{if(!await MenuModel.delete(e.params.id))throw new i(404,"Menu not found");s.send("Menu has been deleted")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},9268:(e,s,t)=>{const a=t(5137),i=t(4870),{validationResult:r}=t(7756),n=t(334);var o=t(5619);n.config(),e.exports=new class{getAll=async(e,s,t)=>{var i=await a.find({tailable:!0,awaitData:!0});s.send(i)};getByUserId=async(e,s,t)=>{const r=o.Types.ObjectId,n=await a.aggregate([{$match:{user_id:r(e.params.id)}},{$lookup:{from:"users",localField:"messages.user_id",foreignField:"_id",as:"user_data"}},{$limit:1},{$project:{messages:{$map:{input:{$zip:{inputs:["$user_data","$messages.messages"]}},as:"el",in:{user_data:{$arrayElemAt:["$$el",0]},messages:{$arrayElemAt:["$$el",1]}}}}}}]);if(!n)throw new i(404,"Message not found");s.send(n[0])};create=async(e,s,t)=>{if(this.checkValidation(e),!await MenuModel.create(e.body))throw new i(500,"Something went wrong");s.status(201).send("Menu was created!")};update=async(e,s,t)=>{this.checkValidation(e);const a=await MenuModel.update(e.body,e.params.id);if(!a)throw new i(404,"Something went wrong");const{affectedRows:r,changedRows:n,info:o}=a,d=r?r&&n?"Menu updated successfully":"Updated faild":"Menu not found";s.send({message:d,info:o})};delete=async(e,s,t)=>{if(!await MenuModel.delete(e.params.id))throw new i(404,"Menu not found");s.send("Menu has been deleted")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},6183:(e,s,t)=>{const a=t(6873);var i=t(4402);e.exports=new class{uploadImage=async(e,s,t)=>{var i=await a.uploads(e.files.photo,e.currentUser._id);s.send(i)};deleteImage=async(e,s,t)=>{var r=new i(e.body.url,!0),n=await a.deleteFile(r.query.id);s.send(n)}}},1464:(e,s,t)=>{var a=t(1121);const i=t(4870),{validationResult:r}=t(7756),n=t(5068),o=t(6873);var d=t(4402);const l=t(334);var u=t(5619);l.config(),e.exports=new class{getAll=async(e,s,t)=>{try{await a.aggregate([{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{"user_data.password":0,"user_data.role":0,user_id:0}}],(function(e,t){e&&console.log(e),s.send(t)}))}catch(e){console.log(e)}};getPublishedAll=async(e,s,t)=>{await a.aggregate([{$match:{status:"Published"}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$project:{name:1,description:1,image_path:1,short_description:1,create_date:1,showcases:1,categories:1,tags:1,descriptions:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":1,"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}}}}],(function(e,t){e&&console.log(e),s.send(t)}))};getByUserPublishedAll=async(e,s,t)=>{const i=u.Types.ObjectId;var r=await a.aggregate([{$match:{user_id:i(e.params.user_id),status:"Published"}}]);s.send(r)};getFindAll=async(e,s,t)=>{a.find({name:{$regex:e.params.text,$options:"i"}},(function(e,t){e&&console.log(e),s.send(t)}))};getAllTop=async(e,s,t)=>{a.aggregate([{$sort:{finalTotal:-1}},{$limit:Number(e.params.count)}]).exec((function(e,t){s.send(t)}))};getById=async(e,s,t)=>{s.send((await this.byId(e.currentUser?e.currentUser.role:n.Client,e.params.id))[0])};getByUserId=async(e,s,t)=>{const i=u.Types.ObjectId;a.aggregate([{$match:{user_id:i(e.params.user_id)}}],(function(e,t){s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e);var i={...e.body,create_date:new Date},r=await a.create(i);e.currentUser.role==n.Client?s.status(201).send(r):s.status(201).send((await this.byId(e.currentUser.role,r._id))[0])};update=async(e,s,t)=>{e.currentUser._id==e.body.user_id||e.currentUser.role!=n.Client?a.updateOne({_id:e.params.id},e.body).then((t=>{t.ok>0?s.status(200).send(e.body):s.status(500).send("GÃ¼ncellenmedi")})):s.status(403).send("Forbidden!")};updateImpression=async(e,s,t)=>{var r=await a.findOne({_id:e.body.id});r&&(0==r.impressions.filter((s=>s.ip==e.body.ip_address)).length?(r.impressions.push({ip:e.body.ip_address,count:1}),a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw new i(e);s.send("Updated!")}))):(r.impressions.find((s=>s.ip==e.body.ip_address)).count+=1,a.updateOne({_id:r._id},r).then((e=>{if(!(e.ok>0))throw new i(e);s.send("Updated!")}))))};delete=async(e,s,t)=>{var i=(await this.byId(e.currentUser.role,e.params.id))[0];if((await a.deleteOne({_id:e.params.id})).deletedCount>0){var r=new d(i.image_path,!0);await o.deleteFile(r.query.id),i.descriptions.forEach((async e=>{if("image"==e.type){var s=new d(e.val,!0);await o.deleteFile(s.query.id)}})),s.status(200).send(e.params.id)}else s.status(500).send("Can't delete!")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)};byId=async(e,s)=>{const t=u.Types.ObjectId;return e==n.Client?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$lookup:{from:"useroptions",localField:"user_id",foreignField:"user_id",as:"user_option"}},{$project:{name:1,description:1,image_path:1,short_description:1,create_date:1,showcases:1,categories:1,tags:1,descriptions:1,"user_data._id":1,"user_data.image_path":{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$user_data.image_path",else:"$$REMOVE"}},"user_data.first_name":{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$user_data.first_name",else:"$$REMOVE"}},"user_data.last_name":{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$user_data.last_name",else:"$$REMOVE"}},"user_data.email":{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$user_data.email",else:"$$REMOVE"}},"user_data.username":{$cond:{if:{$eq:["$user_option.isViewUserName",!0]},then:"$user_data.username",else:"$$REMOVE"}},"user_data.title":{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$user_data.title",else:"$$REMOVE"}}}},{$limit:1}]):e==n.Admin||e==n.SuperUser?await a.aggregate([{$match:{_id:t(s)}},{$lookup:{from:"users",localField:"user_id",foreignField:"_id",as:"user_data"}},{$unwind:"$user_data"},{$project:{user_id:0,"user_data.password":0}},{$limit:1}]):null}}},7598:(e,s,t)=>{const a=t(506),{validationResult:i}=(t(4870),t(7756));t(334).config(),e.exports=new class{getAll=async(e,s,t)=>{a.find((function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{a.findById(e.params.id,(function(e,t){e&&console.log(e),s.send(t)}))};create=async(e,s,t)=>{this.checkValidation(e),a.create(e.body),s.status(201).send("Option was created!")};update=async(e,s,t)=>{a.update(e.params.id,e.body,((e,s)=>{console.log(s)})),s.send("Ok")};delete=async(e,s,t)=>{a.deleteOne(e.params._id,(e=>console.log(e))),s.send("Option has been deleted")}}},6506:(e,s,t)=>{const a=t(8479),i=t(4870),r=t(5068),{validationResult:n}=t(7756);t(334).config(),e.exports=new class{getAll=async(e,s,t)=>{a.find((function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const r=await a.findOne({_id:e.params.id});if(!r)throw new i(404,"User option not found");s.send(r)};getByName=async(e,s,t)=>{const r=await a.findOne({name:e.params.name});if(!r)throw new i(404,"User option not found");s.send(r)};create=async(e,s,t)=>{if(this.checkValidation(e),!await a.create(e.body))throw new i(500,"Something went wrong");s.status(201).send("User option was created!")};update=async(e,s,t)=>{e.currentUser._id==e.body.user_id||e.currentUser.role==r.SuperUser?a.updateOne({_id:e.params.id},e.body).then((t=>{t.ok>0?s.status(200).send(e.body):s.status(500).send("GÃ¼ncellenmedi")})):s.status(403).send("Forbidden!")};delete=async(e,s,t)=>{if(!await a.delete(e.params.id))throw new i(404,"User option not found");s.send("User option has been deleted")};checkValidation=e=>{const s=n(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},7416:(e,s,t)=>{const a=t(6056),i=(t(7693),t(4870)),{validationResult:r}=t(7756),n=t(2773),o=(t(9722),t(334)),d=t(5068),{authLogger:l}=t(615),u=t(9974);var c=t(5619);o.config(),e.exports=new class{verify=async(e,s,t)=>{s.send(!0)};getAllUsers=async(e,s,t)=>{var i=await a.aggregate([{$project:{password:0}}]);s.send(i)};getUserById=async(e,s,t)=>{await a.findById(e.params.id,((e,t)=>{if(e)console.log(e);else{if(!t)throw i(404,"Not found!");{const{password:e,...a}=t._doc;s.send(a)}}}))};getUserProfile=async(e,s,t)=>{c.Types.ObjectId;var i=await a.aggregate([{$match:{username:e.params.username}},{$lookup:{from:"useroptions",localField:"_id",foreignField:"user_id",as:"user_option"}},{$unwind:"$user_option"},{$project:{_id:1,username:1,connections:1,image_path:{$cond:{if:{$eq:["$user_option.isViewImagePath",!0]},then:"$image_path",else:"$$REMOVE"}},first_name:{$cond:{if:{$eq:["$user_option.isViewFirstName",!0]},then:"$first_name",else:"$$REMOVE"}},last_name:{$cond:{if:{$eq:["$user_option.isViewLastName",!0]},then:"$last_name",else:"$$REMOVE"}},email:{$cond:{if:{$eq:["$user_option.isViewEmail",!0]},then:"$email",else:"$$REMOVE"}},title:{$cond:{if:{$eq:["$user_option.isViewTitle",!0]},then:"$title",else:"$$REMOVE"}}}}]);s.send(i[0])};getUserByMail=async(e,s,t)=>{a.aggregate([{$group:{email:s.params.email}}]).exec((function(e,t){s.send(t)}))};getCurrentUser=async(e,s,t)=>{const{password:a,...i}=e.currentUser._doc;s.send({...i})};create=async(e,s,t)=>{if(this.checkValidation(e),await a.findOne({$or:[{email:e.body.email},{username:e.body.username}]}))throw new i(401,"User already exists!");{await this.hashPassword(e);var r={...e.body,create_date:new Date,update_date:null},n=await a.create(r);const{password:t,...i}=n._doc;s.status(201).send(i)}};updateUser=async(e,s,t)=>{if(this.checkValidation(e),e.currentUser._id!=e.body._id&&e.currentUser.role!=d.SuperUser)throw new i(403,"Permission denied!!!");await this.hashPassword(e);const{confirm_password:r,...n}=e.body;var o={...n,update_date:new Date};(await a.updateOne({_id:e.params.id},o)).nModified>0?s.status(200).send(o):s.status(301).send("No updated!")};updateUserStatus=async(e,s,t)=>{this.checkValidation(e),(await a.updateOne({_id:e.params.id},{$set:{status:e.body.status}})).nModified>0?s.status(200).send(e.body):s.status(301).send("Status no updated!")};deleteUser=async(e,s,t)=>{(await a.deleteOne({_id:e.params.id})).deletedCount>0?s.status(200).send(e.params.id):s.status(301).send("No deleted!")};userRegister=async(e,s,t)=>{if(this.checkValidation(e),await a.findOne({$or:[{email:e.body.email},{username:e.body.username}]}))throw new i(401,"User already exists!");await this.hashPassword(e);var r={...e.body,create_date:new Date,update_date:null};await a.create(r).then((t=>{e.session.isAuth=!0,e.session.user_id=t._id,s.status(201).send(!0)}))};userGoogleRegister=async(e,s,t)=>{var a=u.getUrl(e.body);s.send(a)};userLogin=async(e,s,t)=>{this.checkValidation(e);const{email:r,password:o}=e.body;var d;if(!(d=await a.findOne({email:r})))throw l.error(`401 : Unable to login! Email: ${r}`),new i(401,"Unable to login!");if(!await n.compare(o,d.password))throw l.error(`401 : Incorrect password! User: ${d.first_name} ${d.last_name} (${r})`),new i(401,"Incorrect password!");e.session.isAuth=!0,e.session.user_id=d._id,s.status(200).send(e.session.isAuth)};userGoogleLogin=async(e,s,t)=>{};resetPassword=async(e,s,t)=>{this.checkValidation(e),await this.hashPassword(e),a.findOne({_id:e.params.id},(function(s,t){t.password=e.body.password,a.updateOne({_id:t._id},t)})),s.send("Updated!")};checkValidation=e=>{const s=r(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)};hashPassword=async e=>{e.body.password&&(e.body.password=await n.hash(e.body.password,8))}}},678:(e,s,t)=>{const a=t(8386),i=t(4870),r=t(5068),{validationResult:n}=t(7756),o=t(334);var d=t(5619);o.config(),e.exports=new class{getAll=async(e,s,t)=>{a.find((function(e,t){e&&console.log(e),s.send(t)}))};getById=async(e,s,t)=>{const r=await a.findOne({_id:e.params.id});if(!r)throw new i(404,"User option not found");s.send(r)};getByUserId=async(e,s,t)=>{const r=await a.findOne({user_id:e.params.userid});if(!r)throw new i(404,"User option not found");s.send(r)};getByUserTheme=async(e,s,t)=>{const r=d.Types.ObjectId,n=await a.aggregate([{$match:{user_id:r(e.params.userid)}},{$lookup:{from:"themes",localField:"dark",foreignField:"_id",as:"dark"}},{$unwind:"$dark"},{$lookup:{from:"themes",localField:"light",foreignField:"_id",as:"light"}},{$unwind:"$light"},{$project:{dark:1,light:1}}]);if(!n)throw new i(404,"User option not found");s.send(n[0])};create=async(e,s,t)=>{if(this.checkValidation(e),!await a.create(e.body))throw new i(500,"Something went wrong");s.status(201).send("User option was created!")};update=async(e,s,t)=>{e.currentUser._id==e.body.user_id||e.currentUser.role==r.SuperUser?a.updateOne({_id:e.params.id},e.body).then((t=>{t.ok>0?s.status(200).send(e.body):s.status(500).send("GÃ¼ncellenmedi")})):s.status(403).send("Forbidden!")};delete=async(e,s,t)=>{if(!await a.delete(e.params.id))throw new i(404,"User option not found");s.send("User option has been deleted")};checkValidation=e=>{const s=n(e);if(!s.isEmpty())throw new i(400,"Validation faild",s)}}},3275:(e,s,t)=>{var a=t(5619);const{serverLogger:i}=t(615);e.exports=()=>{a.connect("mongodb+srv://wnokroot:!_s2T$$fA98P_W@sihirbazforumcluster.8cff5.mongodb.net/sihirbazfdb?retryWrites=true&w=majority",{useUnifiedTopology:!0,useNewUrlParser:!0}),a.connection.on("open",(()=>{console.log("MongoDB: Connected"),i.info("MongoDB: Connected")})),a.connection.on("error",(e=>{console.log("MongoDB: Error",e),i.error(`MongoDB: Error: ${e.message}`)})),a.Promise=global.Promise}},7693:(e,s,t)=>{const a=t(4870),i=t(6056),{authLogger:r}=t(615);e.exports=(...e)=>async function(s,t,n){try{var o=await i.findOne({_id:s.session.user_id});if(!o)throw new a(401,"Authentication failed!");if(s.session.user_id!=o._id&&e.length&&!e.includes(o.role))throw new a(403,"Unauthorized");s.currentUser=o,n()}catch(e){r.warn(`${s.method} : ${s.originalUrl}`),r.error(`${e.status} : ${e.message}`),n(e)}}},6613:e=>{e.exports=e=>async(s,t,a)=>{try{await e(s,t,a)}catch(e){a(e)}}},8351:(e,s,t)=>{const{serverLogger:a}=t(615);e.exports=function(e,s,t,i){let{status:r=500,message:n,data:o}=e;console.log(`[Error] ${e}`),n=500!==r&&n?n:"Internal server error",404!=(e={type:"error",status:r,message:n,...o&&o}).status??a.error(`[${e.status}] ${e.message}`),t.status(r).send(e)}},7454:(e,s,t)=>{const{check:a}=t(7756);s.createValidateChapter=[a("name").exists().withMessage("Name is required").notEmpty().isLength({min:10}).withMessage("Must be at least 10 chars long").isLength({max:60}).withMessage("Name can contain max 60 characters"),a("short_description").exists().withMessage("Short description is required").notEmpty().isLength({min:20}).withMessage("Must be at least 20 chars long").isLength({max:150}).withMessage("Short description can contain max 150 characters"),a("image_path").exists().withMessage("Image path is required"),a("categories").exists().withMessage("Categories is required").notEmpty().isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("tags").exists().withMessage("Tags is required").notEmpty().isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("descriptions").exists().withMessage("Descriptions is required").notEmpty().isLength({min:2}).withMessage("Must be at least 2 arrays long")],s.updateValidateChapter=[a("name").exists().withMessage("Name is required").notEmpty().isLength({min:15}).withMessage("Must be at least 15 chars long").isLength({max:60}).withMessage("Name can contain max 60 characters"),a("short_description").exists().withMessage("Short description is required").notEmpty().isLength({min:30}).withMessage("Must be at least 30 chars long").isLength({max:150}).withMessage("Short description can contain max 150 characters"),a("image_path").exists().withMessage("Image path is required"),a("categories").exists().withMessage("Categories is required").notEmpty().isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("tags").exists().withMessage("Tags is required").notEmpty().isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("descriptions").exists().withMessage("Descriptions is required").notEmpty().isLength({min:2}).withMessage("Must be at least 2 arrays long")]},9680:(e,s,t)=>{const{check:a}=t(7756);s.createValidateForum=[a("name").exists().withMessage("Name is required").isLength({min:15}).withMessage("Must be at least 15 chars long").isLength({max:60}).withMessage("Name can contain max 60 characters"),a("description").exists().withMessage("Short description is required").isLength({min:30}).withMessage("Must be at least 30 chars long").isLength({max:150}).withMessage("Short description can contain max 150 characters"),a("categories").exists().withMessage("Categories is required").isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("tags").exists().withMessage("Tags is required").isLength({min:1}).withMessage("Must be at least 1 arrays long")],s.updateValidateForum=[a("name").exists().withMessage("Name is required").isLength({min:15}).withMessage("Must be at least 15 chars long").isLength({max:60}).withMessage("Name can contain max 60 characters"),a("description").exists().withMessage("Short description is required").isLength({min:30}).withMessage("Must be at least 30 chars long").isLength({max:150}).withMessage("Short description can contain max 150 characters"),a("categories").exists().withMessage("Categories is required").isLength({min:1}).withMessage("Must be at least 1 arrays long"),a("tags").exists().withMessage("Tags is required").isLength({min:1}).withMessage("Must be at least 1 arrays long")]},7419:(e,s,t)=>{const{check:a}=t(7756);s.validateLibrary=[a("name").exists().withMessage("Library name is required"),a("description").optional(),a("image_path").optional(),a("private").exists().withMessage("Library status is required"),a("contents").exists().withMessage("Library contents is required").isLength({min:1})]},6825:(e,s,t)=>{const{check:a}=t(7756);s.validateMenu=[a("name").exists().withMessage("Blog name is required")]},9141:(e,s,t)=>{const{check:a}=t(7756);s.updateValidateUserOption=[a("password").exists().withMessage("Password is required")]},3270:(e,s,t)=>{const{body:a,check:i}=t(7756),r=t(5068),n=t(3338);s.createUserSchema=[i("first_name").optional(),i("last_name").optional(),i("email").exists().withMessage("Email is required").isEmail().withMessage("Must be a valid email").normalizeEmail(),i("username").exists().withMessage("Username is required").isLength({min:5}).withMessage("Must be at least 5 chars long"),i("role").exists().isIn([r.Admin,r.SuperUser,r.Client]).withMessage("Invalid Role type"),i("password").exists().withMessage("Password is required").notEmpty().isLength({min:6}).withMessage("Password must contain at least 6 characters").isLength({max:20}).withMessage("Password can contain max 20 characters"),i("confirm_password").exists().custom(((e,{req:s})=>e===s.body.password)).withMessage("confirm_password field must have the same value as the password field")],s.clientCreateUserSchema=[i("first_name").optional(),i("last_name").optional(),i("email").exists().withMessage("Email is required").isEmail().withMessage("Must be a valid email").normalizeEmail(),i("username").exists().withMessage("Username is required").isLength({min:5}).withMessage("Must be at least 5 chars long"),i("role").not().isEmpty(),i("password").exists().withMessage("Password is required").notEmpty().isLength({min:6}).withMessage("Password must contain at least 6 characters").isLength({max:20}).withMessage("Password can contain max 20 characters"),i("confirm_password").exists().custom(((e,{req:s})=>e===s.body.password)).withMessage("confirm_password field must have the same value as the password field")],s.updateUserSchema=[i("_id").exists().withMessage("_id is required!"),i("first_name").optional().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:3}).withMessage("Must be at least 3 chars long"),i("last_name").optional().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:3}).withMessage("Must be at least 3 chars long"),i("email").exists().isEmail().withMessage("Must be a valid email").normalizeEmail(),i("username").exists().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:5}).withMessage("Must be at least 5 chars long"),i("role").exists().isIn([r.Admin,r.SuperUser,r.Client]).withMessage("Invalid Role type"),a().custom((e=>!!Object.keys(e).length)).withMessage("Please provide required field to update").custom((e=>{const s=Object.keys(e),t=["_id","username","email","role","first_name","last_name","image_path","create_date","update_date","__v"];return s.every((e=>t.includes(e)))})).withMessage("Invalid updates!")],s.clientUpdateUserSchema=[i("_id").exists().withMessage("_id is required!"),i("first_name").optional().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:3}).withMessage("Must be at least 3 chars long"),i("last_name").optional().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:3}).withMessage("Must be at least 3 chars long"),i("email").exists().isEmail().withMessage("Must be a valid email").normalizeEmail(),i("username").exists().isAlpha().withMessage("Must be only alphabetical chars").isLength({min:5}).withMessage("Must be at least 5 chars long"),i("role").not().isEmpty(),a().custom((e=>!!Object.keys(e).length)).withMessage("Please provide required field to update").custom((e=>{const s=Object.keys(e),t=["_id","username","email","first_name","last_name","image_path","create_date","update_date","__v"];return s.every((e=>t.includes(e)))})).withMessage("Invalid updates!")],s.validateResetPassword=[i("_id").exists().withMessage("_id is required!"),i("password").optional().notEmpty().isLength({min:6}).withMessage("Password must contain at least 6 characters").isLength({max:20}).withMessage("Password can contain max 20 characters").custom(((e,{req:s})=>!!s.body.confirm_password)).withMessage("Please confirm your password"),i("confirm_password").optional().custom(((e,{req:s})=>e===s.body.password)).withMessage("confirm_password field must have the same value as the password field")],s.validateLogin=[i("email").exists().withMessage("Email is required").isEmail().withMessage("Must be a valid email").normalizeEmail(),i("password").exists().withMessage("Password is required").notEmpty().withMessage("Password must be filled")],s.validateStatus=[i("_id").exists(),i("status").exists().withMessage("Status is required!").isIn([n.Online,n.Offline,n.Block]).withMessage("Invalid Status type")]},9192:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({type:String,create_date:Date,descriptions:Object,option:Object});e.exports=a.model("abouts",i)},3310:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({type:String,categories:Array});e.exports=a.model("categories",i)},1529:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({name:String,impressions:Array,categories:Array,description:String,descriptions:Array,status:String,image_path:String,short_description:String,create_date:Date,showcases:Array,tags:Array,user_id:i.ObjectId});e.exports=a.model("chapters",r)},556:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({user_id:{type:i.ObjectId,trim:!0,ref:"users"},create_date:Date,update_date:Date,type:String,data:Object});e.exports=a.model("drafts",r)},7233:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({name:String,impressions:Array,categories:Array,description:String,status:String,create_date:Date,update_date:Date,comments:[{user_id:{type:i.ObjectId,ref:"users"},id:Number,comment_id:Number,description:String,create_date:Date}],short_description:String,tags:Array,connects:Array,user_id:i.ObjectId});e.exports=a.model("forums",r)},6699:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({user_id:{type:i.ObjectId,trim:!0,ref:"users"},name:String,description:String,private:Boolean,image_path:String,contents:[{type:i.ObjectId}]});e.exports=a.model("libraries",r)},7686:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({user_id:{type:i.ObjectId,trim:!0,ref:"users"},create_date:Date,title:String,datas:Array});e.exports=a.model("logs",r)},5960:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({name:String,description:String,path:String,status:Boolean,sort:String,children:Object});e.exports=a.model("menus",i)},5137:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({user_id:{type:i.ObjectId,trim:!0,ref:"users"},messages:[{user_id:{type:i.ObjectId,ref:"users"},messages:[{create_date:Date,text:String,seen:Boolean}]}]});e.exports=a.model("messages",r)},1121:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({name:String,impressions:Array,categories:Array,description:String,descriptions:Array,status:String,image_path:String,short_description:String,create_date:Date,showcases:Array,tags:Array,connects:Array,user_id:i.ObjectId});e.exports=a.model("news",r)},506:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({json_social:Object,ico:String,header_logo:String,main_logo:String,title:String,main_title:String,codedby:String,startus:String});e.exports=a.model("options",i)},8479:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({name:String,mode:String,base_colors:Array,color_scss:Object});e.exports=a.model("themes",i)},6056:(e,s,t)=>{var a=t(5619),i=new(0,a.Schema)({first_name:String,last_name:String,username:String,email:String,password:String,image_path:String,description:String,role:String,title:String,status:String,create_date:Date,update_date:Date,connections:Array,type:String});e.exports=a.model("users",i)},8386:(e,s,t)=>{var a=t(5619),i=a.Schema,r=new i({user_id:{type:i.ObjectId,trim:!0,ref:"users"},isViewFirstName:Boolean,isViewLastName:Boolean,isReveseFullName:Boolean,isViewUserName:Boolean,isViewEmail:Boolean,isViewImagePath:Boolean,isViewDescription:Boolean,isViewRole:Boolean,isViewTitle:Boolean,isViewCreateDate:Boolean,dark:{type:i.ObjectId,trim:!0,ref:"themes"},light:{type:i.ObjectId,trim:!0,ref:"themes"},passwordOptions:{isPrivateKey:Boolean,privateKey:String,minLength:Number,maxLength:Number,isIrregularCharracter:Boolean,minIrregularCharracterLength:Number,maxIrregularCharracterLength:Number,isUpperCase:Boolean,minUpperCaseLength:Number,maxUpperCaseLength:Number,isLowerCase:Boolean,minLowerCaseLength:Number,maxLowerCaseLength:Number,isNumber:Boolean,minNumberLength:Number,maxNumberLength:Number}});e.exports=a.model("useroptions",r)},8256:(e,s,t)=>{const a=t(2127).Router(),i=t(3858),r=t(7693),n=t(5068),o=t(6613);a.get("/",o(i.getAll)),a.get("/type/:type",o(i.getByType)),a.get("/releases",o(i.getReleases)),a.get("/id/:id",r(n.SuperUser),o(i.getById)),a.get("/release/:id",r(n.SuperUser),o(i.getReleaseById)),a.post("/",r(n.SuperUser),o(i.create)),a.put("/id/:id",r(n.SuperUser),o(i.update)),a.delete("/id/:id",r(n.SuperUser),o(i.delete)),e.exports=a},5684:(e,s,t)=>{const a=t(2127).Router(),i=t(1970),r=t(7693),n=(t(5068),t(9974)),o=t(6613),{createUserSchema:d,updateUserSchema:l,validateLogin:u,validateResetPassword:c,validateStatus:p}=t(3270);a.get("/verify",r(),o(i.verify)),a.post("/register",d,o(i.register)),a.post("/google_token",u,o(n.googleToken)),a.get("/login",i.login),a.post("/dologin",u,o(i.doLogin)),a.post("/destroysession",((e,s)=>{e.session.destroy((e=>{if(e)throw e;s.status(200).send(!0)}))})),e.exports=a},8615:(e,s,t)=>{const a=t(2127).Router(),i=t(7395),r=t(7693),n=t(5068),o=t(6613);a.get("/",r(n.SuperUser),o(i.getAll)),a.get("/id/:id",o(i.getById)),a.get("/type/:type",o(i.getByType)),a.post("/",r(n.SuperUser),o(i.create)),a.put("/id/:id",r(n.SuperUser),o(i.update)),a.delete("/id/:id",r(n.SuperUser),o(i.delete)),e.exports=a},9062:(e,s,t)=>{const a=t(2127).Router(),i=t(9828),r=t(7693),n=t(5068),o=t(6613),{createValidateChapter:d,updateValidateChapter:l}=t(7454);a.get("/",r(n.Admin,n.SuperUser),o(i.getAll)),a.get("/client",o(i.getPublishedAll)),a.get("/find/:text",o(i.getFindAll)),a.get("/top/:count",o(i.getAllTop)),a.get("/id/:id",o(i.getById)),a.get("/userid/:user_id",o(i.getByUserId)),a.get("/client/userid/:user_id",o(i.getByUserPublishedAll)),a.post("/",r(),d,o(i.create)),a.put("/id/:id",r(),l,o(i.update)),a.put("/updateImpression/id/:id",o(i.updateImpression)),a.delete("/id/:id",r(n.Admin,n.SuperUser),o(i.delete)),e.exports=a},8835:(e,s,t)=>{const a=t(2127).Router(),i=t(9371),r=t(7693),n=t(5068),o=t(6613);a.get("/",r(n.SuperUser),o(i.getAll)),a.get("/id/:id",r(),o(i.getById)),a.get("/userid/:user_id",r(),o(i.getByUserId)),a.post("/",r(),o(i.create)),a.put("/id/:id",r(),o(i.update)),a.delete("/id/:id",r(),o(i.delete)),e.exports=a},8672:(e,s,t)=>{const a=t(2127).Router(),i=t(2387),r=t(7693),n=t(5068),o=t(6613),{createValidateForum:d,updateValidateForum:l}=t(9680);a.get("/",r(n.Admin,n.SuperUser),o(i.getAll)),a.get("/client",o(i.getPublishedAll)),a.get("/find/:text",o(i.getFindAll)),a.get("/top/:count",o(i.getAllTop)),a.get("/id/:id",o(i.getById)),a.get("/userid/:user_id",r(),o(i.getByUserId)),a.get("/client/userid/:user_id",o(i.getByUserPublishedAll)),a.post("/",r(),d,o(i.create)),a.post("/comment/:id",r(),o(i.createComment)),a.put("/id/:id",r(),l,o(i.update)),a.put("/updateImpression/id/:id",o(i.updateImpression)),a.delete("/id/:id",r(n.Admin,n.SuperUser),o(i.delete)),e.exports=a},8468:(e,s,t)=>{const a=t(2127).Router(),i=t(914),r=t(7693),n=t(5068),o=t(6613),{validateLibrary:d}=t(7419);a.get("/",o(i.getAll)),a.get("/id/:id",o(i.getById)),a.get("/userid/:user_id",o(i.getByUserId)),a.post("/",r(),d,o(i.create)),a.post("/upload",o(i.uploadImage)),a.put("/id/:id",r(),d,o(i.update)),a.put("/updateImpression/id/:id",o(i.updateImpression)),a.delete("/id/:id",r(n.Admin,n.SuperUser),o(i.delete)),e.exports=a},2565:(e,s,t)=>{const a=t(2127).Router(),i=t(6604),r=t(7693),n=t(5068),o=t(6613);a.get("/",r(),o(i.getAll)),a.get("/id/:id",o(i.getById)),a.get("/userid/:user_id",o(i.getByUserId)),a.post("/",r(),o(i.create)),a.post("/upload",o(i.uploadImage)),a.put("/id/:id",r(),o(i.update)),a.delete("/id/:id",r(n.Admin),o(i.delete)),e.exports=a},6569:(e,s,t)=>{const a=t(2127).Router(),i=t(6015),r=t(6613);a.post("/sendmail",r(i.sendMail)),e.exports=a},3852:(e,s,t)=>{const a=t(2127).Router(),i=t(8170),r=t(7693),n=t(5068),o=t(6613),{validateMenu:d}=t(6825);a.get("/",o(i.getAll)),a.get("/id/:id",o(i.getById)),a.post("/",r(n.Admin),d,o(i.create)),a.put("/id/:id",r(n.Admin),d,o(i.update)),a.delete("/id/:id",r(n.Admin),o(i.delete)),e.exports=a},6598:(e,s,t)=>{const a=t(2127).Router(),i=t(9268),r=t(7693),n=t(5068),o=t(6613);a.get("/",o(i.getAll)),a.get("/userid/:id",o(i.getByUserId)),a.post("/",o(i.create)),a.put("/id/:id",r(n.Admin),o(i.update)),a.delete("/id/:id",r(n.Admin),o(i.delete)),e.exports=a},3439:(e,s,t)=>{const a=t(2127).Router(),i=t(6183),r=t(7693),n=t(6613);a.post("/upload",r(),n(i.uploadImage)),a.post("/delete-image",r(),n(i.deleteImage)),e.exports=a},6607:(e,s,t)=>{const a=t(2127).Router(),i=t(1464),r=t(7693),n=t(5068),o=t(6613);a.get("/",r(n.Admin,n.SuperUser),o(i.getAll)),a.get("/client",o(i.getPublishedAll)),a.get("/find/:text",o(i.getFindAll)),a.get("/top/:count",o(i.getAllTop)),a.get("/id/:id",o(i.getById)),a.get("/userid/:user_id",o(i.getByUserId)),a.get("/client/userid/:user_id",o(i.getByUserPublishedAll)),a.post("/",r(),o(i.create)),a.put("/id/:id",r(),o(i.update)),a.put("/updateImpression/id/:id",o(i.updateImpression)),a.delete("/id/:id",r(n.Admin,n.SuperUser),o(i.delete)),e.exports=a},3578:(e,s,t)=>{const a=t(2127).Router(),i=t(7598),r=t(7693),n=t(5068),o=t(6613);a.get("/",o(i.getAll)),a.get("/id/:id",o(i.getById)),a.post("/",r(n.Admin),o(i.create)),a.put("/id/:id",r(n.Admin),o(i.update)),a.delete("/id/:id",r(n.Admin),o(i.delete)),e.exports=a},7888:(e,s,t)=>{const a=t(2127).Router(),i=t(6506),r=t(7693),n=t(5068),o=t(6613);a.get("/",r(),o(i.getAll)),a.get("/id/:id",r(),o(i.getById)),a.get("/userid/:userid",r(),o(i.getByName)),a.post("/",r(n.SuperUser),o(i.create)),a.put("/id/:id",r(n.SuperUser),o(i.update)),a.delete("/id/:id",r(n.SuperUser),o(i.delete)),e.exports=a},6869:(e,s,t)=>{const a=t(2127).Router(),i=t(7416),r=t(7693),n=t(5068),o=t(9974),d=t(6613),{createUserSchema:l,updateUserSchema:u,validateLogin:c,validateResetPassword:p,validateStatus:m}=t(3270);a.get("/",r(n.SuperUser),d(i.getAllUsers)),a.get("/urlgoogle",d(o.getUrl)),a.get("/profile/:username",d(i.getUserProfile)),a.get("/id/:id",r(),d(i.getUserById)),a.get("/username/:username",r(),d(i.getUserByMail)),a.get("/whoami",r(),d(i.getCurrentUser)),a.post("/",r(n.SuperUser),l,d(i.create)),a.post("/resetPassword/:id",r(),p,d(i.resetPassword)),a.put("/id/:id",r(),u,d(i.updateUser)),a.put("/status/:id",r(n.SuperUser),m,d(i.updateUserStatus)),a.delete("/id/:id",r(n.SuperUser),d(i.deleteUser)),e.exports=a},8424:(e,s,t)=>{const a=t(2127).Router(),i=t(678),r=t(7693),n=t(5068),o=t(6613),{validateMenu:d}=t(9141);a.get("/",r(n.SuperUser),o(i.getAll)),a.get("/id/:id",r(n.SuperUser),o(i.getById)),a.get("/userid/:userid",r(),o(i.getByUserId)),a.get("/theme/:userid",r(),o(i.getByUserTheme)),a.post("/",r(n.SuperUser),o(i.create)),a.put("/id/:id",r(),o(i.update)),a.delete("/id/:id",r(n.SuperUser),o(i.delete)),e.exports=a},5877:(e,s,t)=>{const a=t(4995),i=t(2127),r=t(5057),n=t(479),o=t(8351),d=t(8118),l=t(5572),u=t(2473),c=t(358),p=t(5895)(r),m=t(4870),g=t(334),h=t(8256),_=t(8615),w=t(8835),f=t(9062),y=t(6869),$=t(8424),b=t(5684),M=t(3578),v=t(7888),x=t(3852),U=t(6598),V=t(6569),O=t(8672),S=t(6607),k=t(8468),E=t(2565),A=t(3439),I=t(3275),{serverLogger:F}=t(615);I();const q=new p({uri:"mongodb+srv://wnokroot:!_s2T$$fA98P_W@sihirbazforumcluster.8cff5.mongodb.net/sihirbazfdb?retryWrites=true&w=majority",collection:"sessions"}),B=i();B.disable("etag"),g.config(),B.use(a()),B.use(c()),B.use(r({secret:"jkjWll948lkgie9364kOkli3i2i",cookie:{domain:".wizardorbit.com;",maxAge:864e5},saveUninitialized:!1,resave:!1,store:q})),B.use(i.json({limit:"50mb"})),B.use(n({origin:["http://localhost:3000","http://localhost:8080","http://localhost:8081","http://localhost:8082","http://sihirbazblog.com","https://sihirbazblog.com","http://sihirbazforum.com","https://sihirbazforum.com","http://wizardorbit.com","https://wizardorbit.com","http://panel.sihirbazforum.com","https://panel.sihirbazforum.com","http://panel.wizardorbit.com","https://panel.wizardorbit.com"],methods:"GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS",optionsSuccessStatus:200,preflightContinue:!0,credentials:!0,allowedHeaders:"Origin, X-Requested With, Content-Type, Accept",exposedHeaders:["set-cookie"]})),B.options("*",n()),B.engine("ejs",l),B.set("views","./src/views"),B.set("view engine","ejs"),B.use(d({limits:{fileSize:52428800},useTempFiles:!0,tempFileDir:"/tmp/"})),B.use(u.urlencoded({extended:!1})),B.use(u.json()),B.use(i.static("public"));const R=Number("3000");B.use("/api/v1/abouts",h),B.use("/api/v1/categories",_),B.use("/api/v1/drafts",w),B.use("/api/v1/chapters",f),B.use("/api/v1/users",y),B.use("/api/v1/useroptions",$),B.use("/api/v1/auth",b),B.use("/api/v1/options",M),B.use("/api/v1/themes",v),B.use("/api/v1/menus",x),B.use("/api/v1/messages",U),B.use("/api/v1/mail",V),B.use("/api/v1/forums",O),B.use("/api/v1/news",S),B.use("/api/v1/libraries",k),B.use("/api/v1/logs",E),B.use("/api/v1/multiparts",A),B.all("*",((e,s,t)=>{const a=new m(404,"Endpoint Not Found");F.error(`${a.status} : ${a.message} (${e.url})`),t(a)})),B.use(o),B.listen(R,"127.0.0.1",(()=>{console.log(`ð Server running on port ${R}!`),F.info(`ð Server running on port ${R}!`)})),e.exports=B},4870:e=>{class s extends Error{constructor(e,s,t){super(s),this.status=e,this.message=s,this.data=t}}e.exports=s},9974:(e,s,t)=>{const{google:a}=t(2944),i=(t(4402),t(1366),t(2473),t(2376)),r=t(434);e.exports=new class{getUrl(e,s,t){const i=new a.auth.OAuth2("6720531607-f86135p61ij06nc746dbf8ld73i90uun.apps.googleusercontent.com","QjPt67onW59OxJct-Mvm3esr","https://panel.sihirbazforum.com/authenticate/google").generateAuthUrl({access_type:"offline",scope:["https://www.googleapis.com/auth/fitness.activity.read profile email openid"],state:JSON.stringify({callbackUrl:e.body.callbackUrl,userID:e.body.userId})});r(i,((e,t,a)=>{s.send({url:i})}))}async googleToken(e,s,t){console.log(e.body);const r=new a.auth.OAuth2("6720531607-f86135p61ij06nc746dbf8ld73i90uun.apps.googleusercontent.com","QjPt67onW59OxJct-Mvm3esr","https://panel.sihirbazforum.com/authenticate/google"),n=await r.getToken(e.body.code);try{const e=await i({method:"POST",headers:{authorization:"Bearer "+n.tokens.access_token},"Content-Type":"application/json",url:"https://www.googleapis.com/fitness/v1/users/me/dataset:aggregate",data:{aggregateBy:[{dataTypeName:"com.google.step_count.delta",dataSourceId:"derived:com.google.step_count.delta:com.google.android.gms:estimated_steps"}],bucketByTime:{durationMillis:864e5},startTimeMills:1585785599e3,endTimeMills:1585785599e3}});console.log(e);var o=e.data.bucket;console.log(o)}catch(e){console.log(e)}}}},6873:(e,s,t)=>{const a=t(5747),i=t(5622),{uploadLogger:r}=t(615),{google:n}=t(2944);e.exports=new class{uploads=async(e,s)=>{const t=e,n=i.resolve(__dirname,`../uploads/${t.name}`);t.mv(n,(function(e,s){if(e)throw r.error(`[file finalPath] : ${e}`),e}));const o=this.createDriveClient("613669332588-0e5uonb5g2hua7f0tnd00453i0qugqfv.apps.googleusercontent.com","HnYJq-tBgNiLyn8gGXfDukic","https://developers.google.com/oauthplayground","1//04qoM8jCZtwTCCgYIARAAGAQSNwF-L9IrpthAW676Wkt6bkTNCmBlZ_v8izq5ccNdA5TWqXWFo1HROV0VV--mJiXLaHDKSgvh0sA","ya29.a0ARrdaM8xY2Vbn9wXPVcbT3onmfcIALn_I5evBZlxlH55wtWBK7llpDfrLioogMjlqAqws91HyfIEenGJfyX1faUgIBKpAv-C3ifu-oVQ4vWaNNBdOMzzWmAO4HJ5rlMDYSiE8zXde6avx7QGo5Si54PoimDA"),d=await this.searchFolder(o,s);d||(d=await this.createFolder(o,s,"SihirbazImage"));var l=await this.saveFile(o,t.name,n,t.mimetype,d.id).catch((e=>{r.error(`[saveFile] : ${e}`),console.error(e)}));return a.unlinkSync(n),l.data.id};createDriveClient(e,s,t,a,i){const r=new n.auth.OAuth2(e,s,t);return r.setCredentials({refresh_token:a,access_token:i}),n.drive({version:"v3",auth:r})}createFolder=async(e,s,t)=>{var a=await this.searchFolder(e,t);return e.files.create({resource:{name:s,mimeType:"application/vnd.google-apps.folder",parents:a.id},fields:"id, name"})};searchFolder=async(e,s)=>new Promise(((t,a)=>{e.files.list({q:`mimeType='application/vnd.google-apps.folder' and name='${s}'`,fields:"files(id, name)"},((e,s)=>e?(r.error(`[searchFolder] : ${e}`),a(e)):t(s.data.files?s.data.files[0]:null)))}));saveFile(e,s,t,i,r){return e.files.create({requestBody:{name:s,mimeType:i,parents:r?[r]:[],fields:"id"},media:{mimeType:i,body:a.createReadStream(t)}})}deleteFile(e){const s=this.createDriveClient("613669332588-0e5uonb5g2hua7f0tnd00453i0qugqfv.apps.googleusercontent.com","HnYJq-tBgNiLyn8gGXfDukic","https://developers.google.com/oauthplayground","1//04qoM8jCZtwTCCgYIARAAGAQSNwF-L9IrpthAW676Wkt6bkTNCmBlZ_v8izq5ccNdA5TWqXWFo1HROV0VV--mJiXLaHDKSgvh0sA","ya29.a0ARrdaM8xY2Vbn9wXPVcbT3onmfcIALn_I5evBZlxlH55wtWBK7llpDfrLioogMjlqAqws91HyfIEenGJfyX1faUgIBKpAv-C3ifu-oVQ4vWaNNBdOMzzWmAO4HJ5rlMDYSiE8zXde6avx7QGo5Si54PoimDA");return r.warn(`[deleteFile] : ${e}`),s.files.delete({fileId:e})}}},615:(e,s,t)=>{const{createLogger:a,format:i,transports:r}=t(944);var n=a({transports:new r.File({filename:"logs/server.log",format:i.combine(i.timestamp({format:"MMM-DD-YYYY HH:mm:ss"}),i.align(),i.printf((e=>`${e.level}: ${[e.timestamp]}: ${e.message}`)))})});const o=a({transports:[new r.File({filename:"logs/auth.log",format:i.combine(i.timestamp({format:"MMM-DD-YYYY HH:mm:ss"}),i.align(),i.printf((e=>`${e.level}: ${[e.timestamp]}: ${e.message}`)))})]}),d=a({transports:[new r.File({filename:"logs/upload.log",format:i.combine(i.timestamp({format:"MMM-DD-YYYY HH:mm:ss"}),i.align(),i.printf((e=>`${e.level}: ${[e.timestamp]}: ${e.message}`)))})]});e.exports={serverLogger:n,authLogger:o,uploadLogger:d}},5068:e=>{e.exports={Admin:"Admin",SuperUser:"SuperUser",Client:"Client"}},3338:e=>{e.exports={Online:"Online",Offline:"Offline",Block:"Block"}},2376:e=>{"use strict";e.exports=require("axios")},2773:e=>{"use strict";e.exports=require("bcryptjs")},2473:e=>{"use strict";e.exports=require("body-parser")},4995:e=>{"use strict";e.exports=require("compression")},5895:e=>{"use strict";e.exports=require("connect-mongodb-session")},358:e=>{"use strict";e.exports=require("cookie-parser")},479:e=>{"use strict";e.exports=require("cors")},334:e=>{"use strict";e.exports=require("dotenv")},5572:e=>{"use strict";e.exports=require("ejs-mate")},2127:e=>{"use strict";e.exports=require("express")},8118:e=>{"use strict";e.exports=require("express-fileupload")},5057:e=>{"use strict";e.exports=require("express-session")},7756:e=>{"use strict";e.exports=require("express-validator")},5747:e=>{"use strict";e.exports=require("fs")},2944:e=>{"use strict";e.exports=require("googleapis")},9722:e=>{"use strict";e.exports=require("jsonwebtoken")},5619:e=>{"use strict";e.exports=require("mongoose")},8123:e=>{"use strict";e.exports=require("nodemailer")},5622:e=>{"use strict";e.exports=require("path")},1366:e=>{"use strict";e.exports=require("query-string")},434:e=>{"use strict";e.exports=require("request")},4402:e=>{"use strict";e.exports=require("url-parse")},944:e=>{"use strict";e.exports=require("winston")}};var s=require("./runtime.7bda8f22.bundle.js");s.C(e),s(s.s=5877)})();